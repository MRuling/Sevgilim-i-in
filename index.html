<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kübram — Senden Özür Dilerim</title>
    <meta name="description" content="Kübra'ya özel, kalpten bir özür mesajı.">

    <style>
        /* CSS Değişkenleri ile Renk Paleti */
        :root {
            --renk-ana-zemin: #fefefe; /* Krem Beyaz */
            --renk-vurgu: #ffc0cb; /* Açık Pembe */
            --renk-metin: #4c4c4c; /* Yumuşak Gri */
            --renk-ikincil-metin: #8c8c8c; /* Daha Yumuşak Gri */
            --renk-buton: #ff85a2; /* Daha Koyu Pembe */
            --renk-buton-hover: #ff698d;
            --renk-buton-metin: #fff;
            --renk-konfeti-1: #ffb6c1;
            --renk-konfeti-2: #add8e6;
            --renk-konfeti-3: #90ee90;
        }

        /* prefers-reduced-motion Desteği */
        @media (prefers-reduced-motion: reduce) {
            :root {
                --animasyon-suresi: 0s;
            }
            .kalp, .typewriter-metin {
                animation: none !important;
            }
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            height: 100%;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            color: var(--renk-metin);
            background-color: var(--renk-ana-zemin);
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .container {
            max-width: 600px;
            width: 90%;
            padding: 2rem;
            border-radius: 20px;
            background-color: #fff;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            position: relative;
        }

        h1 {
            font-size: 2.5rem;
            color: var(--renk-vurgu);
            letter-spacing: -1px;
            font-weight: 700;
        }
        
        .kalp {
            font-size: 3rem;
            color: var(--renk-vurgu);
            animation: kalpAtisi 1.5s infinite;
            margin-bottom: 1rem;
        }

        @keyframes kalpAtisi {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .typewriter-metin {
            min-height: 150px;
            font-size: 1.1rem;
            line-height: 1.6;
            font-weight: 400;
            white-space: pre-wrap;
            overflow: hidden;
            border-right: 2px solid var(--renk-vurgu);
            padding-right: 5px;
            animation: 
                typing 3s steps(40, end) forwards,
                blink-caret .75s step-end infinite;
            text-align: left;
            margin: 0 auto;
            width: 100%;
            max-width: 500px;
        }

        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }

        @keyframes blink-caret {
            from, to { border-color: transparent; }
            50% { border-color: var(--renk-vurgu); }
        }

        .soru-alani {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .soru-metni {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .butonlar {
            display: flex;
            justify-content: center;
            gap: 1rem;
        }

        .buton {
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            border-radius: 50px;
            color: var(--renk-buton-metin);
            background-color: var(--renk-buton);
            transition: transform 0.2s, background-color 0.2s;
            text-decoration: none;
        }

        .buton:hover {
            background-color: var(--renk-buton-hover);
            transform: scale(1.05);
        }

        .konusma-alani, .tesekkur-alani {
            display: none;
            gap: 1rem;
            flex-direction: column;
            align-items: center;
        }

        .konusma-alani h2, .tesekkur-alani h2 {
            font-size: 1.5rem;
            color: var(--renk-vurgu);
        }

        textarea {
            width: 100%;
            max-width: 400px;
            height: 100px;
            padding: 0.75rem;
            border-radius: 10px;
            border: 1px solid var(--renk-ikincil-metin);
            font-family: inherit;
            resize: none;
        }

        .footer {
            font-size: 0.9rem;
            color: var(--renk-ikincil-metin);
            margin-top: 1rem;
        }

        /* Müzik Butonu */
        .muzik-kontrol {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid var(--renk-vurgu);
            border-radius: 50px;
            padding: 0.5rem;
            cursor: pointer;
            z-index: 10;
        }

        .muzik-kontrol:hover {
            background: rgba(255, 255, 255, 0.8);
        }

        /* Konfeti Canvas */
        #konfeti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
            pointer-events: none;
            display: none; /* Varsayılan olarak gizli */
        }

        /* Giriş Modal'ı */
        .modal-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .modal-content {
            background: #fff;
            padding: 2rem;
            border-radius: 15px;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .modal-content h2 {
            color: var(--renk-vurgu);
            margin-bottom: 1rem;
        }

        .modal-content p {
            margin-bottom: 1.5rem;
            color: var(--renk-metin);
        }
    </style>
</head>
<body>

    <div id="modal" class="modal-bg">
        <div class="modal-content">
            <h2 id="modal-baslik">Kurban olduğum'a</h2>
            <p>Gözlerine kurban olduğum senden böyle özür dilemek istedim gönül isterdi ki kapına çiçekle geliyim ama şuan maalesef mümkün değil:)</p>
            <button id="modal-baslat-butonu" class="buton">Başlayalım</button>
        </div>
    </div>

    <div class="container" role="main" aria-live="polite">
        <button id="muzik-toggle" class="muzik-kontrol" aria-label="Müzik Aç/Kapa">
            <span id="muzik-icon">🎵</span>
        </button>

        <h1 id="baslik-kisi">Canım Sevgilim Senden Özür Dilerim</h1>

        <span class="kalp" role="img" aria-label="Kalp">💖</span>

        <p id="mesaj-alani" class="typewriter-metin" aria-atomic="true">
            Kurban olduğum, seni kırdığım için derin bir pişmanlık duyuyorum. Sözlerimin/ davranışımın seni nasıl etkilediğini düşündükçe içim parçalara ayrılıyor. Hatalıydım ve bunun sorumluluğunu alıyorum. Seni yeniden güldürebilmek için elimden geleni yapmak istiyorum.
        </p>

        <div id="soru-alani" class="soru-alani" style="display: none;">
            <p class="soru-metni">Beni affettin mi?</p>
            <div class="butonlar">
                <button id="evet-butonu" class="buton" aria-label="Evet, affettim">Evet</button>
                <button id="konusalim-butonu" class="buton" aria-label="Hayır, konuşalım">Konuşalım</button>
            </div>
        </div>

        <div id="tesekkur-alani" class="tesekkur-alani">
            <h2>Çok teşekkür ederim!</h2>
            <p>Bu, benim için dünyalara bedel. Seni çok seviyorum ve bu hatayı telafi edeceğim.</p>
            <p>İyi ki varsın bitanem seni çok seviyorum, varlığın gözlerimi parlatmaya, sözlerin beni tekrar var etmeye yeter affettiğin için teşekkürler :)</p>
        </div>
        
        <div id="konusma-alani" class="konusma-alani">
            <h2>Özür dilerim sevgilim</h2>
            <p>Kübram seni kırmak asla istemedim özür dilerim yaptığım bu hata için seni üzdüğüm için sen benim herşeyimsin seni çok seviyorum bitanem 😘🫂 :)</p>
            <textarea placeholder="Buraya kısa bir not yazabilirsin..." aria-label="Kübra'nın cevap notu"></textarea>
            <button class="buton">Gönder</button>
        </div>

        <p class="footer">
            Bu sayfa senin için sevgiyle hazırlandı.
        </p>
    </div>

    <canvas id="konfeti-canvas"></canvas>

    <script>
        // ## KİŞİSELLEŞTİRME: SES
        const ozurSesi = new Audio('https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3'); // Farklı bir linkle değiştirilebilir.
        let isMuzikCaliyor = false;

        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('modal');
            const modalBaslatButonu = document.getElementById('modal-baslat-butonu');
            const mesajAlani = document.getElementById('mesaj-alani');
            const soruAlani = document.getElementById('soru-alani');
            const evetButonu = document.getElementById('evet-butonu');
            const konusalimButonu = document.getElementById('konusalim-butonu');
            const tesekkurAlani = document.getElementById('tesekkur-alani');
            const konusmaAlani = document.getElementById('konusma-alani');
            const muzikToggle = document.getElementById('muzik-toggle');
            const muzikIcon = document.getElementById('muzik-icon');

            // Typewriter efekti
            function typewriterYaz(metinElementi, metin, bitisCallback) {
                let i = 0;
                metinElementi.textContent = "";
                metinElementi.style.animation = "none";
                metinElementi.offsetWidth; // DOM'u yeniden çizmeye zorla
                metinElementi.style.animation = "typing 3s steps(40, end) forwards";

                const yaziInterval = setInterval(() => {
                    if (i < metin.length) {
                        metinElementi.textContent += metin.charAt(i);
                        i++;
                    } else {
                        clearInterval(yaziInterval);
                        if (bitisCallback) bitisCallback();
                    }
                }, 50); // Yazma hızı

                // prefers-reduced-motion desteği
                if (window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
                    metinElementi.textContent = metin;
                    if (bitisCallback) bitisCallback();
                }
            }

            // Modal'ı kapat ve sayfayı başlat
            modalBaslatButonu.addEventListener('click', () => {
                modal.style.display = 'none';
                typewriterYaz(mesajAlani, mesajAlani.textContent.trim(), () => {
                    setTimeout(() => {
                        soruAlani.style.display = 'flex';
                        soruAlani.setAttribute('aria-live', 'polite');
                    }, 1000);
                });
            });

            // Müzik kontrolü
            muzikToggle.addEventListener('click', () => {
                if (isMuzikCalmiyor) {
                    ozurSesi.pause();
                    muzikIcon.textContent = '🎵';
                } else {
                    ozurSesi.play().catch(e => console.error("Müzik çalma hatası:", e));
                    muzikIcon.textContent = '⏸️';
                }
                isMuzikCalmiyor = !isMuzikCalmiyor;
            });
            
            // "Evet" butonuna tıklama
            evetButonu.addEventListener('click', () => {
                soruAlani.style.display = 'none';
                tesekkurAlani.style.display = 'flex';
                // Konfeti animasyonunu başlat
                baslatKonfeti();
                // Ekran okuyucuya bilgi ver
                tesekkurAlani.setAttribute('aria-live', 'polite');
            });

            // "Konuşalım" butonuna tıklama
            konusalimButonu.addEventListener('click', () => {
                soruAlani.style.display = 'none';
                konusmaAlani.style.display = 'flex';
                // Ekran okuyucuya bilgi ver
                konusmaAlani.setAttribute('aria-live', 'polite');
            });


            // Konfeti Animasyonu (Canvas)
            const canvas = document.getElementById('konfeti-canvas');
            const ctx = canvas.getContext('2d');
            const konfetiSayisi = 100;
            const konfetiler = [];
            
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            window.addEventListener('resize', resizeCanvas, false);
            resizeCanvas();

            function Konfeti(x, y) {
                this.x = x;
                this.y = y;
                this.boyut = Math.random() * 10 + 5;
                this.donme = Math.random() * 360;
                this.hizX = Math.random() * 5 - 2.5;
                this.hizY = Math.random() * -5 - 5;
                this.renk = `rgb(${Math.random() * 255}, ${Math.random() * 255}, ${Math.random() * 255})`;
                this.aci = Math.random() * Math.PI * 2;
                this.donmeHizi = Math.random() * 0.1 - 0.05;

                this.guncelle = function() {
                    this.hizY += 0.1; // Yerçekimi
                    this.x += this.hizX;
                    this.y += this.hizY;
                    this.donme += this.donmeHizi;
                };

                this.ciz = function() {
                    ctx.save();
                    ctx.translate(this.x, this.y);
                    ctx.rotate(this.donme);
                    ctx.fillStyle = this.renk;
                    ctx.fillRect(-this.boyut / 2, -this.boyut / 2, this.boyut, this.boyut);
                    ctx.restore();
                };
            }

            function baslatKonfeti() {
                if (window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
                    return; // Animasyonu çalıştırma
                }
                
                canvas.style.display = 'block';
                konfetiler.length = 0; // Diziyi temizle
                for (let i = 0; i < konfetiSayisi; i++) {
                    konfetiler.push(new Konfeti(canvas.width / 2, canvas.height / 2));
                }

                function animasyonDongusu() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    for (let i = 0; i < konfetiler.length; i++) {
                        konfetiler[i].guncelle();
                        konfetiler[i].ciz();
                    }

                    // Konfetiler ekran dışına çıktığında temizle
                    konfetiler = konfetiler.filter(c => c.y < canvas.height);

                    if (konfetiler.length > 0) {
                        requestAnimationFrame(animasyonDongusu);
                    } else {
                        canvas.style.display = 'none'; // Animasyon bittiğinde gizle
                    }
                }
                animasyonDongusu();
            }
        });
    </script>
</body>
</html>
